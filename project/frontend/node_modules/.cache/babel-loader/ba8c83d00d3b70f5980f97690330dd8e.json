{"ast":null,"code":"var _jsxFileName = \"/Users/asiataylor/Development/env1/django-drf-react/project/frontend/src/components/views/Category.js\";\nimport React, { Component } from 'react';\nimport { connect } from \"react-redux\";\nimport '../static/Home.css';\nimport { Link } from 'react-router-dom';\nimport Navbar from './Navbar';\nimport { FaComments, FaTimes, FaPlus } from 'react-icons/fa';\nimport IconButton from '@material-ui/core/IconButton';\nimport { headers } from '../forms/global.js';\n\nclass Category extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      topics: [],\n      category: \"\",\n      hidden: true,\n      topic: \"\",\n      user_topics: []\n    };\n\n    this.show = e => {\n      this.setState({\n        hidden: !this.state.hidden\n      });\n    };\n\n    this.topic_cb = () => {\n      this.fetchTopics();\n      this.fetchUserTopics();\n    };\n  }\n\n  fetchTopics() {\n    fetch(\"/api/topic/\".concat(this.props.match.params.category_id, \"/\")).then(response => {\n      return response.json();\n    }).then(responseData => {\n      return responseData;\n    }).then(json => {\n      this.setState({\n        topics: json.data\n      });\n      this.setState({\n        category: json.category\n      });\n    }).catch(err => {\n      console.log(\"fetch error\" + err);\n    });\n  }\n\n  fetchUserTopics() {\n    headers[\"Authorization\"] = \"Token \".concat(this.props.token);\n    fetch(\"/api/user_topics/\", {\n      headers,\n      method: \"GET\"\n    }).then(res => {\n      return res.json();\n    }).then(responseData => {\n      return responseData;\n    }).then(json => this.setState({\n      user_topics: json\n    })).catch(err => {\n      console.log(\"fetch error\" + err);\n    });\n  }\n\n  addTopic(created_by, category, name) {\n    let body = JSON.stringify({\n      created_by,\n      category,\n      name\n    });\n    headers[\"Authorization\"] = \"Token \".concat(this.props.token);\n    fetch(\"/api/topic/\".concat(this.props.match.params.category_id, \"/\"), {\n      headers,\n      body,\n      method: \"POST\"\n    }).then(res => {\n      return res.json();\n    }).then(responseData => {\n      return responseData;\n    }).then(this.topic_cb).catch(err => {\n      console.log(\"fetch error\" + err);\n    });\n  }\n\n  topicSubmit(e) {\n    e.preventDefault();\n    this.addTopic(this.props.user.id, this.props.match.params.category_id, this.state.topic);\n  }\n\n  deleteUserTopic(id) {\n    let body = JSON.stringify({\n      id\n    });\n    headers[\"Authorization\"] = \"Token \".concat(this.props.token);\n    fetch(\"/api/user_topics/\", {\n      headers,\n      body,\n      method: \"DELETE\"\n    }).then(res => {\n      return res.json();\n    }).then(responseData => {\n      return responseData;\n    }).then(this.topic_cb).catch(err => {\n      console.log(\"fetch error\" + err);\n    });\n  }\n\n  componentWillMount() {\n    this.topic_cb();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"category\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(Navbar, {\n      history: this.props.history,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"flex-box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"forum-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"recent-topics\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, \"Your Topics\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, this.state.user_topics.length > 0 ? React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, this.state.user_topics.map((el, idx) => {\n      return [React.createElement(\"li\", {\n        key: idx,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(IconButton, {\n        onClick: e => {\n          e.preventDefault();\n          this.deleteUserTopic(el.id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, React.createElement(FaTimes, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      })), React.createElement(Link, {\n        to: this.props.match.params.category_id + '/' + el.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, el.name))];\n    })) : React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, \"No items \"))), React.createElement(\"div\", {\n      id: \"category-list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"forum-h1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, this.state.category), React.createElement(\"table\", {\n      className: \"table\",\n      id: \"about-me\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(IconButton, {\n      onClick: this.show,\n      className: \"new-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(FaPlus, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    })), \" Topic\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"Posts\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      onChange: e => this.setState({\n        topic: e.target.value\n      }),\n      className: this.state.hidden ? 'hidden' : 'input-small',\n      type: \"text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    })), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.topicSubmit.bind(this),\n      className: this.state.hidden ? 'hidden' : 'submit',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"Add\"))), this.state.topics.map((el, idx) => {\n      return [React.createElement(\"tr\", {\n        key: idx,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: this.props.match.params.category_id + '/' + el.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, el.name)), React.createElement(\"td\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(FaComments, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }), \" \", el.posts))];\n    })))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token,\n    user: state.auth.user\n  };\n};\n\nexport default connect(mapStateToProps)(Category);","map":{"version":3,"sources":["/Users/asiataylor/Development/env1/django-drf-react/project/frontend/src/components/views/Category.js"],"names":["React","Component","connect","Link","Navbar","FaComments","FaTimes","FaPlus","IconButton","headers","Category","state","topics","category","hidden","topic","user_topics","show","e","setState","topic_cb","fetchTopics","fetchUserTopics","fetch","props","match","params","category_id","then","response","json","responseData","data","catch","err","console","log","token","method","res","addTopic","created_by","name","body","JSON","stringify","topicSubmit","preventDefault","user","id","deleteUserTopic","componentWillMount","render","history","length","map","el","idx","target","value","bind","posts","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {connect} from \"react-redux\";\nimport '../static/Home.css';\nimport {Link} from 'react-router-dom';\nimport Navbar from './Navbar';\nimport {FaComments,FaTimes,FaPlus} from 'react-icons/fa';\nimport IconButton from '@material-ui/core/IconButton';\nimport {headers} from '../forms/global.js'\n\n\nclass Category extends Component{\n\n  state = {\n    topics:[],\n    category:\"\",\n    hidden:true,\n    topic:\"\",\n    user_topics:[]\n  }\n\n  show = (e) =>{\n    this.setState({hidden:!this.state.hidden})\n  }\n\n  fetchTopics(){\n    fetch(`/api/topic/${this.props.match.params.category_id}/`)\n      .then(response => { return response.json();}).then(responseData => {return responseData;})\n      .then (json =>{this.setState({topics: json.data});this.setState({category:json.category})})\n      .catch(err => {console.log(\"fetch error\" + err);\n       });\n  }\n\n  fetchUserTopics(){\n    headers[\"Authorization\"] = `Token ${this.props.token}`;\n    fetch(`/api/user_topics/`, {headers,method:\"GET\"})\n      .then(res => {return res.json();}).then(responseData => {return responseData;})\n      .then (json =>this.setState({user_topics: json}))\n      .catch(err => {console.log(\"fetch error\" + err)})\n    }\n\n  addTopic(created_by,category,name){\n      let body = JSON.stringify({created_by,category,name});\n      headers[\"Authorization\"] = `Token ${this.props.token}`;\n      fetch(`/api/topic/${this.props.match.params.category_id}/`, {headers,body,method:\"POST\"})\n        .then(res => {return res.json();}).then(responseData => {return responseData;})\n        .then(this.topic_cb)\n        .catch(err => {console.log(\"fetch error\" + err)})\n    }\n\n    topic_cb = () =>{\n      this.fetchTopics()\n      this.fetchUserTopics()\n    }\n\n    topicSubmit(e){\n      e.preventDefault();\n      this.addTopic(this.props.user.id,this.props.match.params.category_id,this.state.topic)\n    }\n\n    deleteUserTopic(id){\n      let body = JSON.stringify({id});\n      headers[\"Authorization\"] = `Token ${this.props.token}`;\n      fetch(`/api/user_topics/`, {headers,body,method:\"DELETE\"})\n        .then(res => {return res.json();}).then(responseData => {return responseData;})\n        .then(this.topic_cb)\n        .catch(err => {console.log(\"fetch error\" + err)})\n      }\n\n    componentWillMount(){\n      this.topic_cb()\n    }\n\n    render(){\n      return(\n      <div id=\"category\">\n        <header>\n          <Navbar history={this.props.history}/>\n        </header>\n        <div className=\"flex-box\">\n          <div className=\"forum-body\">\n             <div id=\"recent-topics\">\n              <h2>Your Topics</h2>\n            <div>\n            {this.state.user_topics.length > 0 ?\n              <ul>\n              {\n                this.state.user_topics.map((el,idx) => {\n                    return[\n                        <li  key={idx}>\n                          <IconButton onClick={e=>{e.preventDefault();this.deleteUserTopic(el.id);} }><FaTimes/></IconButton>\n                          <Link to={this.props.match.params.category_id+'/'+el.id}>{el.name}</Link>\n                        </li>\n                    ];\n                })\n              }\n            </ul> : <p>No items </p>}\n            </div>\n            </div>\n\n            <div id=\"category-list\">\n              <h1 className=\"forum-h1\">{this.state.category}</h1>\n              <table className=\"table\" id=\"about-me\">\n                <thead>\n                  <tr>\n                    <th><IconButton onClick={this.show} className=\"new-item\"><FaPlus/></IconButton> Topic</th>\n                    <th>Posts</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td><input onChange={e=>this.setState({topic:e.target.value})} className={this.state.hidden ? 'hidden':'input-small'} type=\"text\"/></td>\n                    <td><button onClick={this.topicSubmit.bind(this)} className={this.state.hidden ? 'hidden':'submit'}>Add</button></td>\n                  </tr>\n                {\n                  this.state.topics.map((el,idx) => {\n                      return[\n                        <tr key={idx}>\n                          <td><Link to={this.props.match.params.category_id+'/'+el.id}>{el.name}</Link></td>\n                          <td><FaComments/> {el.posts}</td>\n                        </tr>\n                      ];\n                  })\n                }\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n      )\n    }\n  }\n\nconst mapStateToProps = state => {\n    return {\n      token:state.auth.token,\n      user: state.auth.user,\n    }\n}\n\nexport default connect(mapStateToProps)(Category);\n"]},"metadata":{},"sourceType":"module"}